from datetime import datetime

from docx import Document
from docx.enum.section import WD_SECTION
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.shared import Cm, Pt


STUDENT_FULL_NAME = "Романов Даниил Сергеевич"
STUDENT_SHORT = "Романов Д.С."


def configure_page(document: Document) -> None:
    section = document.sections[0]
    section.top_margin = Cm(2)
    section.bottom_margin = Cm(2)
    section.left_margin = Cm(2)
    section.right_margin = Cm(2)

    style = document.styles["Normal"].font
    style.name = "Times New Roman"
    style.size = Pt(14)


def add_title_page(document: Document, main_title: str, subtitle: str | None = None) -> None:
    p = document.add_paragraph()
    p.alignment = WD_ALIGN_PARAGRAPH.CENTER
    run = p.add_run("Московский финансово-экономический колледж")
    run.bold = True

    p2 = document.add_paragraph()
    p2.alignment = WD_ALIGN_PARAGRAPH.CENTER
    p2.add_run(main_title).bold = True

    if subtitle:
        p3 = document.add_paragraph()
        p3.alignment = WD_ALIGN_PARAGRAPH.CENTER
        p3.add_run(subtitle)

    document.add_paragraph()
    document.add_paragraph()

    info = document.add_paragraph()
    info.alignment = WD_ALIGN_PARAGRAPH.LEFT
    info.add_run(f"Выполнил: {STUDENT_FULL_NAME} ({STUDENT_SHORT})\n")
    info.add_run(f"Дата: {datetime.today().strftime('%d.%m.%Y')}")

    document.add_section(WD_SECTION.NEW_PAGE)


def add_heading(document: Document, text: str) -> None:
    p = document.add_paragraph()
    p.alignment = WD_ALIGN_PARAGRAPH.LEFT
    run = p.add_run(text)
    run.bold = True


def add_text(document: Document, text: str) -> None:
    for paragraph in text.strip().split("\n\n"):
        p = document.add_paragraph(paragraph.strip())
        p_format = p.paragraph_format
        p_format.line_spacing = 1.5


def build_answers_doc() -> Document:
    doc = Document()
    configure_page(doc)
    add_title_page(
        doc,
        "Ответы на контрольные вопросы по теме \"Финансы как экономика\"",
        "С указанием российских источников",
    )

    qas: list[tuple[str, str]] = [
        (
            "1. В чем заключается сущность финансовой науки?",
            (
                "Сущность финансовой науки заключается в изучении закономерностей формирования, распределения "
                "и использования фондов денежных средств на уровнях государства, организаций и домашних хозяйств. "
                "Она исследует финансовые отношения и механизмы, через которые осуществляется перераспределение "
                "доходов и капитала, а также влияние финансов на экономическое развитие."
            ),
        ),
        (
            "2. Назовите предмет финансовой науки.",
            (
                "Предметом финансовой науки являются финансовые отношения по поводу образования, распределения "
                "и использования денежных фондов, а также финансовые категории, инструменты и институты, "
                "обеспечивающие эти процессы (бюджет, налоги, государственный и банковский кредит, страхование, "
                "финансовые рынки)."
            ),
        ),
        (
            "3. Какая цель финансовой науки?",
            (
                "Цель финансовой науки — обоснование принципов и инструментов эффективной финансовой политики, "
                "обеспечивающей устойчивый экономический рост, социальную справедливость и сбалансированность "
                "публичных и частных финансов."
            ),
        ),
        (
            "4. Охарактеризуйте понятие \"финансы\".",
            (
                "Финансы — это система экономических отношений по формированию, распределению и использованию "
                "денежных фондов в целях выполнения функций государства и обеспечения деятельности организаций "
                "и домашних хозяйств."
            ),
        ),
        (
            "5. Что понимается под понятием \"финансовые отношения\" и какие перераспределительные процессы они опосредуют?",
            (
                "Финансовые отношения — это денежные отношения между субъектами экономики по поводу движения "
                "стоимости в форме доходов, расходов и накоплений. Они опосредуют первичное распределение ВВП, "
                "межотраслевое и межтерриториальное перераспределение доходов, перераспределение между секторами "
                "государства и бизнеса, а также внутрикорпоративное и межбюджетное перераспределение."
            ),
        ),
        (
            "6. Охарактеризуйте централизованные финансы и децентрализованные финансы.",
            (
                "Централизованные финансы — это публичные финансы, формируемые и используемые государством: "
                "бюджетная система, государственные внебюджетные фонды, государственный кредит. "
                "Децентрализованные финансы — финансы организаций и домашних хозяйств, где решения о распределении "
                "денежных средств принимаются на уровне отдельных хозяйствующих субъектов."
            ),
        ),
        (
            "7. Охарактеризуйте признаки финансов.",
            (
                "К ключевым признакам относятся: денежная форма отношений; целевой характер формирования фондов; "
                "двустороннее движение стоимости (доходы—расходы); распределительный и перераспределительный характер; "
                "наличие специализированных институтов и инструментов (налоги, бюджет, кредит, страхование)."
            ),
        ),
        (
            "8. В чем заключается бифункциональный научный подход при определении функций финансов?",
            (
                "Бифункциональный подход сводит функции финансов к двум базовым: распределительной (включая "
                "перераспределение) и контрольной. Остальные функции (регулирующая, стимулирующая, стабилизационная) "
                "рассматриваются как производные проявления базовых."
            ),
        ),
        (
            "9. Охарактеризуйте основные функции финансов.",
            (
                "Основные функции: 1) распределительная — формирование и перераспределение доходов и фондов; "
                "2) контрольная — контроль за образованием и использованием денежных ресурсов; 3) регулирующая/" 
                "стимулирующая — влияние финансовых методов на экономическое поведение; 4) стабилизационная — "
                "поддержание макроэкономической и социальной устойчивости через бюджетную и налоговую политику."
            ),
        ),
        (
            "10. В чем заключаются особенности контрольной функции.",
            (
                "Контрольная функция проявляется в количественной измеримости финансовых потоков и обязательности "
                "их документального отражения, что позволяет выявлять отклонения от планов и норм, обеспечивать "
                "финансовую дисциплину и ответственность участников, а также принимать корректирующие решения "
                "в финансовой политике."
            ),
        ),
    ]

    for question, answer in qas:
        add_heading(doc, question)
        add_text(doc, answer)

    add_heading(doc, "Список использованных источников (российские)")
    sources = [
        (
            "Бабич А.М., Павлова Л.Н. Финансы: учебник. — М.: Юрайт, 2021.",
        ),
        (
            "Грязнова А.Г., Вахрушина М.А. Финансы, денежное обращение и кредит: учебник. — М.: КНОРУС, 2020.",
        ),
        (
            "Минфин России. Материалы о бюджетной системе РФ — https://minfin.gov.ru/",
        ),
        (
            "Банк России. Публикации о финансовом рынке — https://cbr.ru/",
        ),
        (
            "Юткина Т.Ю. Финансы: учебник. — М.: Инфра-М, 2015.",
        ),
    ]
    for s in sources:
        add_text(doc, f"— {s}")

    return doc


def build_report_doc() -> Document:
    doc = Document()
    configure_page(doc)
    add_title_page(
        doc,
        "Доклад: Понятие и структура финансовой системы",
        None,
    )

    intro = (
        "Этот короткий доклад написан в учебных целях. Я постарался простыми словами описать, "
        "что понимают под финансовой системой и из каких частей она состоит. Текст отражает базовые "
        "представления, которые обычно формируются после первых занятий по дисциплине \"Финансы\"."
    )
    add_text(doc, intro)

    concept = (
        "Финансовая система — это упорядоченная совокупность сфер и институтов, через которые движутся деньги "
        "в экономике. Проще говоря, это механизм, который помогает собирать средства, распределять их между "
        "важными направлениями и контролировать, чтобы они использовались по назначению."
    )
    add_heading(doc, "Понятие финансовой системы")
    add_text(doc, concept)

    structure = (
        "Обычно выделяют несколько основных элементов финансовой системы. Во‑первых, это государственные финансы: "
        "бюджеты разных уровней и специальные внебюджетные фонды. Во‑вторых, финансы организаций — деньги, "
        "с которыми работают предприятия и некоммерческие структуры. В‑третьих, домохозяйства — финансы "
        "населения. Отдельно стоят страхование и кредитно-банковская система. Все эти элементы связаны между собой: "
        "налоги и взносы формируют доходы государства, банки перераспределяют временно свободные средства, "
        "страхование помогает управлять рисками."
    )
    add_heading(doc, "Структура финансовой системы")
    add_text(doc, structure)

    roles = (
        "Зачем все это нужно? Финансовая система решает практические задачи: собирает ресурсы на общие цели, "
        "поддерживает развитие бизнеса, защищает людей от финансовых рисков и задает понятные правила обращения "
        "денег. Через налоги и расходы бюджета государство влияет на экономику и социальную сферу, а через банки "
        "и рынки капитала бизнес получает источники финансирования."
    )
    add_heading(doc, "Роль и значение")
    add_text(doc, roles)

    finish = (
        "Итог. Финансовая система — это не одна организация и даже не только государство. Это целая сеть правил, "
        "организаций и денежных потоков. Понимание ее устройства помогает разбираться, откуда берутся средства, "
        "как они распределяются и почему важно соблюдать финансовую дисциплину."
    )
    add_text(doc, finish)

    return doc


def main() -> None:
    answers_doc = build_answers_doc()
    answers_doc.save("/workspace/Kontrolnye_voprosy_Romanov_DS.docx")

    report_doc = build_report_doc()
    report_doc.save("/workspace/Doklad_Finansovaya_sistema_Romanov_DS.docx")


if __name__ == "__main__":
    main()

